;if(!window.console){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var i=0;i<names.length;++i)window.console[names[i]]=function(){}}
;(function(b){b.support.touch="ontouchend"in document;if(!b.support.touch){return}var c=b.ui.mouse.prototype,e=c._mouseInit,a;function d(g,h){if(g.originalEvent.touches.length>1){return}g.preventDefault();var i=g.originalEvent.changedTouches[0],f=document.createEvent("MouseEvents");f.initMouseEvent(h,true,true,window,1,i.screenX,i.screenY,i.clientX,i.clientY,false,false,false,false,0,null);g.target.dispatchEvent(f)}c._touchStart=function(g){var f=this;if(a||!f._mouseCapture(g.originalEvent.changedTouches[0])){return}a=true;f._touchMoved=false;d(g,"mouseover");d(g,"mousemove");d(g,"mousedown")};c._touchMove=function(f){if(!a){return}this._touchMoved=true;d(f,"mousemove")};c._touchEnd=function(f){if(!a){return}d(f,"mouseup");d(f,"mouseout");if(!this._touchMoved){d(f,"click")}a=false};c._mouseInit=function(){var f=this;f.element.bind("touchstart",b.proxy(f,"_touchStart")).bind("touchmove",b.proxy(f,"_touchMove")).bind("touchend",b.proxy(f,"_touchEnd"));e.call(f)}})(jQuery)
;(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1}});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return allowEmpty||!prop.def?null:prop.def}value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def}if(type.mod){return(value+type.mod)%type.mod}return 0>value?0:type.max<value?type.max:value}function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent)}return inst}return colors[string]}color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this}if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined}var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array"}if(type==="string"){return this.parse(stringParse(red)||colors._default)}if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)});return this}if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice()}})}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return}inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,true)});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache])}}})}return this}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=isCache[prop.idx]===localCache[prop.idx];return same}})}return same});return same},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName)}});return used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return}if(startValue===null){result[index]=endValue}else{if(type.mod){if(endValue-startValue>type.mod/2){startValue+=type.mod}else if(startValue-endValue>type.mod/2){startValue-=type.mod}}result[index]=clamp((endValue-startValue)*distance+startValue,prop)}});return this[spaceName](result)},blend:function(opaque){if(this._rgba[3]===1){return this}var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?i>2?1:0:v});if(rgba[3]===1){rgba.pop();prefix="rgb("}return prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0}if(i&&i<3){v=Math.round(v*100)+"%"}return v});if(hsla[3]===1){hsla.pop();prefix="hsl("}return prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255))}return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6}if(h*2<1){return q}if(h*3<2){return p+(q-p)*(2/3-h)*6}return p}spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]]}var r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*.5,h,s;if(min===max){h=0}else if(r===max){h=60*(g-b)/diff+360}else if(g===max){h=60*(b-r)/diff+120}else{h=60*(r-g)/diff+240}if(diff===0){s=0}else if(l<=.5){s=diff/add}else{s=diff/(2-add)}return[Math.round(h)%360,s,l,a==null?1:a]};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]]}var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+1/3)*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-1/3)*255),a]};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba)}if(value===undefined){return this[cache].slice()}var ret,type=jQuery.type(value),arr=type==="array"||type==="object"?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx]}local[prop.idx]=clamp(val,prop)});if(from){ret=color(from(local));ret[cache]=local;return ret}else{return color(local)}};each(props,function(key,prop){if(color.fn[key]){return}color.fn[key]=function(value){var vtype=jQuery.type(value),fn=key==="alpha"?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur}if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value)}if(value==null&&prop.empty){return this}if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1)}}local[prop.idx]=value;return this[fn](local)}})});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(jQuery.type(value)!=="string"||(parsed=stringParse(value))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode}catch(e){}}value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true}jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value});return expanded}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery)
;(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){return new wrapper(obj)};if(typeof module!=="undefined"&&module.exports){module.exports=_;_._=_}else{root["_"]=_}_.VERSION="1.2.0";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(hasOwnProperty.call(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=memo!==void 0;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return memo!==void 0?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var reversed=(_.isArray(obj)?obj.slice():_.toArray(obj)).reverse();return _.reduce(reversed,iterator,memo,context)};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return result};var any=_.some=_.any=function(obj,iterator,context){iterator=iterator||_.identity;var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result|=iterator.call(context,value,index,list))return breaker});return!!result};_.include=_.contains=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;any(obj,function(value){if(found=value===target)return true});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(method.call?method||value:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var shuffled=[],rand;each(obj,function(value,index,list){if(index==0){shuffled[0]=value}else{rand=Math.floor(Math.random()*(index+1));shuffled[index]=shuffled[rand];shuffled[rand]=value}});return shuffled};_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")};_.groupBy=function(obj,iterator){var result={};each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)});return result};_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low};_.toArray=function(iterable){if(!iterable)return[];if(iterable.toArray)return iterable.toArray();if(_.isArray(iterable))return slice.call(iterable);if(_.isArguments(iterable))return slice.call(iterable);return _.values(iterable)};_.size=function(obj){return _.toArray(obj).length};_.first=_.head=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){return n!=null&&!guard?slice.call(array,array.length-n):array[array.length-1]};_.rest=_.tail=function(array,index,guard){return slice.call(array,index==null||guard?1:index)};_.compact=function(array){return _.filter(array,function(value){return!!value})};_.flatten=function(array){return _.reduce(array,function(memo,value){if(_.isArray(value))return memo.concat(_.flatten(value));memo[memo.length]=value;return memo},[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array;var result=[];_.reduce(initial,function(memo,el,i){if(0==i||(isSorted===true?_.last(memo)!=el:!_.include(memo,el))){memo[memo.length]=el;result[result.length]=array[i]}return memo},[]);return result};_.union=function(){return _.uniq(_.flatten(arguments))};_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array,other){return _.filter(array,function(value){return!_.include(other,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};_.bind=function(func,obj){if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));var args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return hasOwnProperty.call(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};var limit=function(func,wait,debounce){var timeout;return function(){var context=this,args=arguments;var throttler=function(){timeout=null;func.apply(context,args)};if(debounce)clearTimeout(timeout);if(debounce||!timeout)timeout=setTimeout(throttler,wait)}};_.throttle=function(func,wait){return limit(func,wait,false)};_.debounce=function(func,wait){return limit(func,wait,true)};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;return memo=func.apply(this,arguments)}};_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments));return wrapper.apply(this,args)}};_.compose=function(){var funcs=slice.call(arguments);return function(){var args=slice.call(arguments);for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(hasOwnProperty.call(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){return _.map(obj,_.identity)};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(source[prop]!==void 0)obj[prop]=source[prop]}});return obj};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}});return obj};_.clone=function(obj){return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};function eq(a,b,stack){if(a===b)return a!==0||1/a==1/b;if(a==null)return a===b;var typeA=typeof a;if(typeA!=typeof b)return false;if(!a!=!b)return false;if(_.isNaN(a))return _.isNaN(b);var isStringA=_.isString(a),isStringB=_.isString(b);if(isStringA||isStringB)return isStringA&&isStringB&&String(a)==String(b);var isNumberA=_.isNumber(a),isNumberB=_.isNumber(b);if(isNumberA||isNumberB)return isNumberA&&isNumberB&&+a==+b;var isBooleanA=_.isBoolean(a),isBooleanB=_.isBoolean(b);if(isBooleanA||isBooleanB)return isBooleanA&&isBooleanB&&+a==+b;var isDateA=_.isDate(a),isDateB=_.isDate(b);if(isDateA||isDateB)return isDateA&&isDateB&&a.getTime()==b.getTime();var isRegExpA=_.isRegExp(a),isRegExpB=_.isRegExp(b);if(isRegExpA||isRegExpB){return isRegExpA&&isRegExpB&&a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeA!="object")return false;if(a._chain)a=a._wrapped;if(b._chain)b=b._wrapped;if(_.isFunction(a.isEqual))return a.isEqual(b);var length=stack.length;while(length--){if(stack[length]==a)return true}stack.push(a);var size=0,result=true;if(a.length===+a.length||b.length===+b.length){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=size in a==size in b&&eq(a[size],b[size],stack)))break}}}else{for(var key in a){if(hasOwnProperty.call(a,key)){size++;if(!(result=hasOwnProperty.call(b,key)&&eq(a[key],b[key],stack)))break}}if(result){for(key in b){if(hasOwnProperty.call(b,key)&&!(size--))break}result=!size}}stack.pop();return result}_.isEqual=function(a,b){return eq(a,b,[])};_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(hasOwnProperty.call(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType==1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};_.isArguments=function(obj){return!!(obj&&hasOwnProperty.call(obj,"callee"))};_.isFunction=function(obj){return!!(obj&&obj.constructor&&obj.call&&obj.apply)};_.isString=function(obj){return!!(obj===""||obj&&obj.charCodeAt&&obj.substr)};_.isNumber=function(obj){return!!(obj===0||obj&&obj.toExponential&&obj.toFixed)};_.isNaN=function(obj){return obj!==obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isDate=function(obj){return!!(obj&&obj.getTimezoneOffset&&obj.setUTCFullYear)};_.isRegExp=function(obj){return!!(obj&&obj.test&&obj.exec&&(obj.ignoreCase||obj.ignoreCase===false))};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)};_.escape=function(string){return(""+string).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};_.template=function(str,data){var c=_.templateSettings;var tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};"+"with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(match,code){return"',_.escape("+code.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(match,code){return"',"+code.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(match,code){return"');"+code.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var func=new Function("obj",tmpl);return data?func(data):func};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj};var addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);unshift.call(args,this._wrapped);return result(func.apply(_,args),this._chain)}};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){method.apply(this._wrapped,arguments);return result(this._wrapped,this._chain)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}});wrapper.prototype.chain=function(){this._chain=true;return this};wrapper.prototype.value=function(){return this._wrapped}})()
;(function(){var root=this;var previousBackbone=root.Backbone;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="0.5.3";var _=root._;if(!_&&typeof require!=="undefined")_=require("underscore")._;var $=root.jQuery||root.Zepto;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;Backbone.Events={bind:function(ev,callback,context){var calls=this._callbacks||(this._callbacks={});var list=calls[ev]||(calls[ev]=[]);list.push([callback,context]);return this},unbind:function(ev,callback){var calls;if(!ev){this._callbacks={}}else if(calls=this._callbacks){if(!callback){calls[ev]=[]}else{var list=calls[ev];if(!list)return this;for(var i=0,l=list.length;i<l;i++){if(list[i]&&callback===list[i][0]){list[i]=null;break}}}}return this},trigger:function(eventName){var list,calls,ev,callback,args;var both=2;if(!(calls=this._callbacks))return this;while(both--){ev=both?eventName:"all";if(list=calls[ev]){for(var i=0,l=list.length;i<l;i++){if(!(callback=list[i])){list.splice(i,1);i--;l--}else{args=both?Array.prototype.slice.call(arguments,1):arguments;callback[0].apply(callback[1]||this,args)}}}}return this}};Backbone.Model=function(attributes,options){var defaults;attributes||(attributes={});if(defaults=this.defaults){if(_.isFunction(defaults))defaults=defaults.call(this);attributes=_.extend({},defaults,attributes)}this.attributes={};this._escapedAttributes={};this.cid=_.uniqueId("c");this.set(attributes,{silent:true});this._changed=false;this._previousAttributes=_.clone(this.attributes);if(options&&options.collection)this.collection=options.collection;this.initialize(attributes,options)};_.extend(Backbone.Model.prototype,Backbone.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},get:function(attr){return this.attributes[attr]},escape:function(attr){var html;if(html=this._escapedAttributes[attr])return html;var val=this.attributes[attr];return this._escapedAttributes[attr]=escapeHTML(val==null?"":""+val)},has:function(attr){return this.attributes[attr]!=null},set:function(attrs,options){options||(options={});if(!attrs)return this;if(attrs.attributes)attrs=attrs.attributes;var now=this.attributes,escaped=this._escapedAttributes;if(!options.silent&&this.validate&&!this._performValidation(attrs,options))return false;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];var alreadyChanging=this._changing;this._changing=true;for(var attr in attrs){var val=attrs[attr];if(!_.isEqual(now[attr],val)){now[attr]=val;delete escaped[attr];this._changed=true;if(!options.silent)this.trigger("change:"+attr,this,val,options)}}if(!alreadyChanging&&!options.silent&&this._changed)this.change(options);this._changing=false;return this},unset:function(attr,options){if(!(attr in this.attributes))return this;options||(options={});var value=this.attributes[attr];var validObj={};validObj[attr]=void 0;if(!options.silent&&this.validate&&!this._performValidation(validObj,options))return false;delete this.attributes[attr];delete this._escapedAttributes[attr];if(attr==this.idAttribute)delete this.id;this._changed=true;if(!options.silent){this.trigger("change:"+attr,this,void 0,options);this.change(options)}return this},clear:function(options){options||(options={});var attr;var old=this.attributes;var validObj={};for(attr in old)validObj[attr]=void 0;if(!options.silent&&this.validate&&!this._performValidation(validObj,options))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!options.silent){for(attr in old){this.trigger("change:"+attr,this,void 0,options)}this.change(options)}return this},fetch:function(options){options||(options={});var model=this;var success=options.success;options.success=function(resp,status,xhr){if(!model.set(model.parse(resp,xhr),options))return false;if(success)success(model,resp)};options.error=wrapError(options.error,model,options);return(this.sync||Backbone.sync).call(this,"read",this,options)},save:function(attrs,options){options||(options={});if(attrs&&!this.set(attrs,options))return false;var model=this;var success=options.success;options.success=function(resp,status,xhr){if(!model.set(model.parse(resp,xhr),options))return false;if(success)success(model,resp,xhr)};options.error=wrapError(options.error,model,options);var method=this.isNew()?"create":"update";return(this.sync||Backbone.sync).call(this,method,this,options)},destroy:function(options){options||(options={});if(this.isNew())return this.trigger("destroy",this,this.collection,options);var model=this;var success=options.success;options.success=function(resp){model.trigger("destroy",model,model.collection,options);if(success)success(model,resp)};options.error=wrapError(options.error,model,options);return(this.sync||Backbone.sync).call(this,"delete",this,options)},url:function(){var base=getUrl(this.collection)||this.urlRoot||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,xhr){return resp},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(options){this.trigger("change",this,options);this._previousAttributes=_.clone(this.attributes);this._changed=false},hasChanged:function(attr){if(attr)return this._previousAttributes[attr]!=this.attributes[attr];return this._changed},changedAttributes:function(now){now||(now=this.attributes);var old=this._previousAttributes;var changed=false;for(var attr in now){if(!_.isEqual(old[attr],now[attr])){changed=changed||{};changed[attr]=now[attr]}}return changed},previous:function(attr){if(!attr||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},_performValidation:function(attrs,options){var error=this.validate(attrs);if(error){if(options.error){options.error(this,error,options)}else{this.trigger("error",this,error,options)}return false}return true}});Backbone.Collection=function(models,options){options||(options={});if(options.comparator)this.comparator=options.comparator;_.bindAll(this,"_onModelEvent","_removeReference");this._reset();if(models)this.reset(models,{silent:true});this.initialize.apply(this,arguments)};_.extend(Backbone.Collection.prototype,Backbone.Events,{model:Backbone.Model,initialize:function(){},toJSON:function(){return this.map(function(model){return model.toJSON()})},add:function(models,options){if(_.isArray(models)){for(var i=0,l=models.length;i<l;i++){this._add(models[i],options)}}else{this._add(models,options)}return this},remove:function(models,options){if(_.isArray(models)){for(var i=0,l=models.length;i<l;i++){this._remove(models[i],options)}}else{this._remove(models,options)}return this},get:function(id){if(id==null)return null;return this._byId[id.id!=null?id.id:id]},getByCid:function(cid){return cid&&this._byCid[cid.cid||cid]},at:function(index){return this.models[index]},sort:function(options){options||(options={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);if(!options.silent)this.trigger("reset",this,options);return this},pluck:function(attr){return _.map(this.models,function(model){return model.get(attr)})},reset:function(models,options){models||(models=[]);options||(options={});this.each(this._removeReference);this._reset();this.add(models,{silent:true});if(!options.silent)this.trigger("reset",this,options);return this},fetch:function(options){options||(options={});var collection=this;var success=options.success;options.success=function(resp,status,xhr){collection[options.add?"add":"reset"](collection.parse(resp,xhr),options);if(success)success(collection,resp)};options.error=wrapError(options.error,collection,options);return(this.sync||Backbone.sync).call(this,"read",this,options)},create:function(model,options){var coll=this;options||(options={});model=this._prepareModel(model,options);if(!model)return false;var success=options.success;options.success=function(nextModel,resp,xhr){coll.add(nextModel,options);if(success)success(nextModel,resp,xhr)};model.save(null,options);return model},parse:function(resp,xhr){return resp},chain:function(){return _(this.models).chain()},_reset:function(options){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(model,options){if(!(model instanceof Backbone.Model)){var attrs=model;model=new this.model(attrs,{collection:this});if(model.validate&&!model._performValidation(attrs,options))model=false}else if(!model.collection){model.collection=this}return model},_add:function(model,options){options||(options={});model=this._prepareModel(model,options);if(!model)return false;var already=this.getByCid(model);if(already)throw new Error(["Can't add the same model to a set twice",already.id]);this._byId[model.id]=model;this._byCid[model.cid]=model;var index=options.at!=null?options.at:this.comparator?this.sortedIndex(model,this.comparator):this.length;this.models.splice(index,0,model);model.bind("all",this._onModelEvent);this.length++;if(!options.silent)model.trigger("add",model,this,options);return model},_remove:function(model,options){options||(options={});model=this.getByCid(model)||this.get(model);if(!model)return null;delete this._byId[model.id];delete this._byCid[model.cid];this.models.splice(this.indexOf(model),1);this.length--;if(!options.silent)model.trigger("remove",model,this,options);this._removeReference(model);return model},_removeReference:function(model){if(this==model.collection){delete model.collection}model.unbind("all",this._onModelEvent)},_onModelEvent:function(ev,model,collection,options){if((ev=="add"||ev=="remove")&&collection!=this)return;if(ev=="destroy"){this._remove(model,options)}if(model&&ev==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];this._byId[model.id]=model}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];_.each(methods,function(method){Backbone.Collection.prototype[method]=function(){return _[method].apply(_,[this.models].concat(_.toArray(arguments)))}});Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var namedParam=/:([\w\d]+)/g;var splatParam=/\*([\w\d]+)/g;var escapeRegExp=/[-[\]{}()+?.,\\^$|#\s]/g;_.extend(Backbone.Router.prototype,Backbone.Events,{initialize:function(){},route:function(route,name,callback){Backbone.history||(Backbone.history=new Backbone.History);if(!_.isRegExp(route))route=this._routeToRegExp(route);Backbone.history.route(route,_.bind(function(fragment){var args=this._extractParameters(route,fragment);callback.apply(this,args);this.trigger.apply(this,["route:"+name].concat(args))},this))},navigate:function(fragment,triggerRoute){Backbone.history.navigate(fragment,triggerRoute)},_bindRoutes:function(){if(!this.routes)return;var routes=[];for(var route in this.routes){routes.unshift([route,this.routes[route]])}for(var i=0,l=routes.length;i<l;i++){this.route(routes[i][0],routes[i][1],this[routes[i][1]])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(namedParam,"([^/]*)").replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){return route.exec(fragment).slice(1)}});Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl")};var hashStrip=/^#*/;var isExplorer=/msie [\w.]+/;var historyStarted=false;_.extend(Backbone.History.prototype,{interval:50,getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||forcePushState){fragment=window.location.pathname;var search=window.location.search;if(search)fragment+=search;if(fragment.indexOf(this.options.root)==0)fragment=fragment.substr(this.options.root.length)}else{fragment=window.location.hash}}return decodeURIComponent(fragment.replace(hashStrip,""))},start:function(options){if(historyStarted)throw new Error("Backbone.history has already been started");this.options=_.extend({},{root:"/"},this.options,options);this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);if(oldIE){this.iframe=$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){$(window).bind("popstate",this.checkUrl)}else if("onhashchange"in window&&!oldIE){$(window).bind("hashchange",this.checkUrl)}else{setInterval(this.checkUrl,this.interval)}this.fragment=fragment;historyStarted=true;var loc=window.location;var atRoot=loc.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=loc.hash.replace(hashStrip,"");window.history.replaceState({},document.title,loc.protocol+"//"+loc.host+this.options.root+this.fragment)}if(!this.options.silent){return this.loadUrl()}},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current==this.fragment&&this.iframe)current=this.getFragment(this.iframe.location.hash);if(current==this.fragment||current==decodeURIComponent(this.fragment))return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,triggerRoute){var frag=(fragment||"").replace(hashStrip,"");if(this.fragment==frag||this.fragment==decodeURIComponent(frag))return;if(this._hasPushState){var loc=window.location;if(frag.indexOf(this.options.root)!=0)frag=this.options.root+frag;this.fragment=frag;window.history.pushState({},document.title,loc.protocol+"//"+loc.host+frag)}else{window.location.hash=this.fragment=frag;if(this.iframe&&frag!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=frag}}if(triggerRoute)this.loadUrl(fragment)}});Backbone.View=function(options){this.cid=_.uniqueId("view");this._configure(options||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var selectorDelegate=function(selector){return $(selector,this.el)};var eventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName"];_.extend(Backbone.View.prototype,Backbone.Events,{tagName:"div",$:selectorDelegate,initialize:function(){},render:function(){return this},remove:function(){$(this.el).remove();return this},make:function(tagName,attributes,content){var el=document.createElement(tagName);if(attributes)$(el).attr(attributes);if(content)$(el).html(content);return el},delegateEvents:function(events){if(!(events||(events=this.events)))return;if(_.isFunction(events))events=events.call(this);$(this.el).unbind(".delegateEvents"+this.cid);for(var key in events){var method=this[events[key]];if(!method)throw new Error('Event "'+events[key]+'" does not exist');var match=key.match(eventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){$(this.el).bind(eventName,method)}else{$(this.el).delegate(selector,eventName,method)}}},_configure:function(options){if(this.options)options=_.extend({},this.options,options);for(var i=0,l=viewOptions.length;i<l;i++){var attr=viewOptions[i];if(options[attr])this[attr]=options[attr]}this.options=options},_ensureElement:function(){if(!this.el){var attrs=this.attributes||{};if(this.id)attrs.id=this.id;if(this.className)attrs["class"]=this.className;this.el=this.make(this.tagName,attrs)}else if(_.isString(this.el)){this.el=$(this.el).get(0)}}});var extend=function(protoProps,classProps){var child=inherits(this,protoProps,classProps);child.extend=this.extend;return child};Backbone.Model.extend=Backbone.Collection.extend=Backbone.Router.extend=Backbone.View.extend=extend;var methodMap={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};Backbone.sync=function(method,model,options){var type=methodMap[method];var params=_.extend({type:type,dataType:"json"},options);if(!params.url){params.url=getUrl(model)||urlError()}if(!params.data&&model&&(method=="create"||method=="update")){params.contentType="application/json";params.data=JSON.stringify(model.toJSON())}if(Backbone.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(Backbone.emulateHTTP){if(type==="PUT"||type==="DELETE"){if(Backbone.emulateJSON)params.data._method=type;params.type="POST";params.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type)}}}if(params.type!=="GET"&&!Backbone.emulateJSON){params.processData=false}return $.ajax(params)};var ctor=function(){};var inherits=function(parent,protoProps,staticProps){var child;if(protoProps&&protoProps.hasOwnProperty("constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent);ctor.prototype=parent.prototype;child.prototype=new ctor;if(protoProps)_.extend(child.prototype,protoProps);if(staticProps)_.extend(child,staticProps);child.prototype.constructor=child;child.__super__=parent.prototype;return child};var getUrl=function(object){if(!(object&&object.url))return null;return _.isFunction(object.url)?object.url():object.url};var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(onError,model,options){return function(resp){if(onError){onError(model,resp,options)}else{model.trigger("error",model,resp,options)}}};var escapeHTML=function(string){return string.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}}).call(this)
;(function(a,b){var c="/",d=50,e=0,f=function(){},g=function(){var a;return function(b){var c=!1;return _.isString(b)?(c=b===a,a=b):(c=_.isEqual(b,a),a=_.clone(b)),!c}},h=function(a,b){this.exchange=a,this.topic=b};h.prototype={subscribe:function(a){var b=new i(this.exchange,this.topic,a);return l.configuration.bus.subscribe(b),b},publish:function(a){l.configuration.bus.publish({exchange:this.exchange,topic:this.topic,data:a,timeStamp:new Date})}};var i=function(a,b,c){this.exchange=a,this.topic=b,this.callback=c,this.priority=d,this.constraints=[],this.maxCalls=e,this.onHandled=f,this.context=null};i.prototype={unsubscribe:function(){l.configuration.bus.unsubscribe(this)},defer:function(){var a=this.callback;return this.callback=function(b){setTimeout(a,0,b)},this},disposeAfter:function(a){if(_.isNaN(a)||a<=0)throw"The value provided to disposeAfter (maxCalls) must be a number greater than zero.";var b=this.onHandled,c=_.after(a,_.bind(function(){this.unsubscribe(this)},this));return this.onHandled=function(){b.apply(this.context,arguments),c()},this},ignoreDuplicates:function(){return this.withConstraint(new g),this},whenHandledThenExecute:function(a){if(!_.isFunction(a))throw"Value provided to 'whenHandledThenExecute' must be a function";return this.onHandled=a,this},withConstraint:function(a){if(!_.isFunction(a))throw"Predicate constraint must be a function";return this.constraints.push(a),this},withConstraints:function(a){var b=this;return _.isArray(a)&&_.each(a,function(a){b.withConstraint(a)}),b},withContext:function(a){return this.context=a,this},withDebounce:function(a){if(_.isNaN(a))throw"Milliseconds must be a number";var b=this.callback;return this.callback=_.debounce(b,a),this},withDelay:function(a){if(_.isNaN(a))throw"Milliseconds must be a number";var b=this.callback;return this.callback=function(c){setTimeout(b,a,c)},this},withPriority:function(a){if(_.isNaN(a))throw"Priority must be a number";return this.priority=a,this},withThrottle:function(a){if(_.isNaN(a))throw"Milliseconds must be a number";var b=this.callback;return this.callback=_.throttle(b,a),this}};var j={cache:{},compare:function(a,b){if(this.cache[b]&&this.cache[b][a])return!0;var c=new RegExp("^"+this.regexify(a)+"$"),d=c.test(b);return d&&(this.cache[b]||(this.cache[b]={}),this.cache[b][a]=!0),d},regexify:function(a){return a.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/#/g,"[A-Z,a-z,0-9]*")}},k={subscriptions:{},wireTaps:[],publish:function(a){_.each(this.wireTaps,function(b){b({exchange:a.exchange,topic:a.topic,data:a.data,timeStamp:a.timeStamp})}),_.each(this.subscriptions[a.exchange],function(b){_.each(b,function(b){l.configuration.resolver.compare(b.topic,a.topic)&&_.all(b.constraints,function(b){return b(a.data)})&&typeof b.callback=="function"&&(b.callback.apply(b.context,[a.data]),b.onHandled())})})},subscribe:function(a){var b,c,d;this.subscriptions[a.exchange]||(this.subscriptions[a.exchange]={}),this.subscriptions[a.exchange][a.topic]||(this.subscriptions[a.exchange][a.topic]=[]),b=this.subscriptions[a.exchange][a.topic].length-1;if(!_.any(this.subscriptions[a.exchange][a.topic],function(b){return b===a})){for(;b>=0;b--)if(this.subscriptions[a.exchange][a.topic][b].priority<=a.priority){this.subscriptions[a.exchange][a.topic].splice(b+1,0,a),c=!0;break}c||this.subscriptions[a.exchange][a.topic].unshift(a)}return _.bind(function(){this.unsubscribe(a)},this)},unsubscribe:function(a){if(this.subscriptions[a.exchange][a.topic]){var b=this.subscriptions[a.exchange][a.topic].length,c=0;for(;c<b;c++)if(this.subscriptions[a.exchange][a.topic][c]===a){this.subscriptions[a.exchange][a.topic].splice(c,1);break}}},addWireTap:function(a){return this.wireTaps.push(a),function(){var b=this.wireTaps.indexOf(a);b!==-1&&this.wireTaps.splice(b,1)}}},l={configuration:{bus:k,resolver:j},channel:function(a,b){var d=arguments.length===2?a:c,e=arguments.length===2?b:a;return new h(d,e)},subscribe:function(a,b,d){var e=arguments.length===3?a:c,f=arguments.length===3?b:a,g=this.channel(e,f);return g.subscribe(d)},publish:function(a,b,d){var e=arguments.length===3?a:c,f=arguments.length===3?b:a,g=this.channel(e,f);g.publish(d)},addWireTap:function(a){this.configuration.bus.addWireTap(a)}};a.postal=l})(window)
;jQuery(function($){$.ajaxSetup({cache:false});$("[data-module]").each(function(){var $this=$(this),module=$this.data("module");require({baseUrl:"/scripts/modules"},[module],function(module){module.init.call($this,$this.data("parameters"))})})})
;!function(a){a(function(){a.support.transition=function(){var a=function(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in b)if(a.style[c]!==undefined)return b[c]}();return a&&{end:a}}()})}(window.jQuery),!function(a){var b=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c);if(this.isShown||c.isDefaultPrevented())return;a("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in").attr("aria-hidden",!1).focus(),b.enforceFocus(),c?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")})},hide:function(b){b&&b.preventDefault();var c=this;b=a.Event("hide"),this.$element.trigger(b);if(!this.isShown||b.isDefaultPrevented())return;this.isShown=!1,a("body").removeClass("modal-open"),this.escape(),a(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),a.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var b=this;a(document).on("focusin.modal",function(a){b.$element[0]!==a.target&&!b.$element.has(a.target).length&&b.$element.focus()})},escape:function(){var a=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(b){b.which==27&&a.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),b.hideModal()},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),b.hideModal()})},hideModal:function(a){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(a.proxy(this.hide,this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(this.removeBackdrop,this)):this.removeBackdrop()):b&&b()}},a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=a.extend({},a.fn.modal.defaults,d.data(),typeof c=="object"&&c);e||d.data("modal",e=new b(this,f)),typeof c=="string"?e[c]():f.show&&e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=b,a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f).one("hide",function(){c.focus()})})})}(window.jQuery),!function(a){function d(){e(a(b)).removeClass("open")}function e(b){var c=b.attr("data-target"),d;return c||(c=b.attr("href"),c=c&&c.replace(/.*(?=#[^\s]*$)/,"")),d=a(c),d.length||(d=b.parent()),d}var b="[data-toggle=dropdown]",c=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};c.prototype={constructor:c,toggle:function(b){var c=a(this),f,g;if(c.is(".disabled, :disabled"))return;return f=e(c),g=f.hasClass("open"),d(),g||(f.toggleClass("open"),c.focus()),!1},keydown:function(b){var c,d,f,g,h,i;if(!/(38|40|27)/.test(b.keyCode))return;c=a(this),b.preventDefault(),b.stopPropagation();if(c.is(".disabled, :disabled"))return;g=e(c),h=g.hasClass("open");if(!h||h&&b.keyCode==27)return c.click();d=a("[role=menu] li:not(.divider) a",g);if(!d.length)return;i=d.index(d.filter(":focus")),b.keyCode==38&&i>0&&i--,b.keyCode==40&&i<d.length-1&&i++,~i||(i=0),d.eq(i).focus()}},a.fn.dropdown=function(b){return this.each(function(){var d=a(this),e=d.data("dropdown");e||d.data("dropdown",e=new c(this)),typeof b=="string"&&e[b].call(d)})},a.fn.dropdown.Constructor=c,a(function(){a("html").on("click.dropdown.data-api touchstart.dropdown.data-api",d),a("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown",function(a){a.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",b,c.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",b+", [role=menu]",c.prototype.keydown)})}(window.jQuery),!function(a){function b(b,c){var d=a.proxy(this.process,this),e=a(b).is("body")?a(window):a(b),f;this.options=a.extend({},a.fn.scrollspy.defaults,c),this.$scrollElement=e.on("scroll.scroll-spy.data-api",d),this.selector=(this.options.target||(f=a(b).attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=a("body"),this.refresh(),this.process()}b.prototype={constructor:b,refresh:function(){var b=this,c;this.offsets=a([]),this.targets=a([]),c=this.$body.find(this.selector).map(function(){var b=a(this),c=b.data("target")||b.attr("href"),d=/^#\w/.test(c)&&a(c);return d&&d.length&&[[d.position().top,c]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},process:function(){var a=this.$scrollElement.scrollTop()+this.options.offset,b=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,c=b-this.$scrollElement.height(),d=this.offsets,e=this.targets,f=this.activeTarget,g;if(a>=c)return f!=(g=e.last()[0])&&this.activate(g);for(g=d.length;g--;)f!=e[g]&&a>=d[g]&&(!d[g+1]||a<=d[g+1])&&this.activate(e[g])},activate:function(b){var c,d;this.activeTarget=b,a(this.selector).parent(".active").removeClass("active"),d=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',c=a(d).parent("li").addClass("active"),c.parent(".dropdown-menu").length&&(c=c.closest("li.dropdown").addClass("active")),c.trigger("activate")}},a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("scrollspy"),f=typeof c=="object"&&c;e||d.data("scrollspy",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.defaults={offset:10},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(window.jQuery),!function(a){var b=function(b){this.element=a(b)};b.prototype={constructor:b,show:function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.attr("data-target"),e,f,g;d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,""));if(b.parent("li").hasClass("active"))return;e=c.find(".active a").last()[0],g=a.Event("show",{relatedTarget:e}),b.trigger(g);if(g.isDefaultPrevented())return;f=a(d),this.activate(b.parent("li"),c),this.activate(f,f.parent(),function(){b.trigger({type:"shown",relatedTarget:e})})},activate:function(b,c,d){function g(){e.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),f?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var e=c.find("> .active"),f=d&&a.support.transition&&e.hasClass("fade");f?e.one(a.support.transition.end,g):g(),e.removeClass("in")}},a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("tab");e||d.data("tab",e=new b(this)),typeof c=="string"&&e[c]()})},a.fn.tab.Constructor=b,a(function(){a("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})})}(window.jQuery),!function(a){var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this)):this.options.trigger!="manual"&&(e=this.options.trigger=="hover"?"mouseenter":"focus",f=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&typeof b.delay=="number"&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show)return c.show();clearTimeout(this.timeout),c.hoverState="in",this.timeout=setTimeout(function(){c.hoverState=="in"&&c.show()},c.options.delay.show)},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!c.options.delay||!c.options.delay.hide)return c.hide();c.hoverState="out",this.timeout=setTimeout(function(){c.hoverState=="out"&&c.hide()},c.options.delay.hide)},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f=typeof this.options.placement=="function"?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight;switch(b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass(f).addClass("in")}},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function d(){var b=setTimeout(function(){c.off(a.support.transition.end).remove()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.remove()})}var b=this,c=this.tip();return c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d():c.remove(),this},fixTitle:function(){var a=this.$element;(a.attr("title")||typeof a.attr("data-original-title")!="string")&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||(typeof c.title=="function"?c.title.call(b[0]):c.title),a},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f=typeof c=="object"&&c;e||d.data("tooltip",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery),!function(a){var b=function(a,b){this.init("popover",a,b)};b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content > *")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-content")||(typeof c.content=="function"?c.content.call(b[0]):c.content),a},tip:function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("popover"),f=typeof c=="object"&&c;e||d.data("popover",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(a){var b=function(b,c){this.options=a.extend({},a.fn.affix.defaults,c),this.$window=a(window).on("scroll.affix.data-api",a.proxy(this.checkPosition,this)),this.$element=a(b),this.checkPosition()};b.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var b=a(document).height(),c=this.$window.scrollTop(),d=this.$element.offset(),e=this.options.offset,f=e.bottom,g=e.top,h="affix affix-top affix-bottom",i;typeof e!="object"&&(f=g=e),typeof g=="function"&&(g=e.top()),typeof f=="function"&&(f=e.bottom()),i=this.unpin!=null&&c+this.unpin<=d.top?!1:f!=null&&d.top+this.$element.height()>=b-f?"bottom":g!=null&&c<=g?"top":!1;if(this.affixed===i)return;this.affixed=i,this.unpin=i=="bottom"?d.top-c:null,this.$element.removeClass(h).addClass("affix"+(i?"-"+i:""))},a.fn.affix=function(c){return this.each(function(){var d=a(this),e=d.data("affix"),f=typeof c=="object"&&c;e||d.data("affix",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.affix.Constructor=b,a.fn.affix.defaults={offset:0},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})}(window.jQuery),!function(a){var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function f(){e.trigger("closed").remove()}var c=a(this),d=c.attr("data-target"),e;d||(d=c.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),e=a(d),b&&b.preventDefault(),e.length||(e=c.hasClass("alert")?c:c.parent()),e.trigger(b=a.Event("close"));if(b.isDefaultPrevented())return;e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.on(a.support.transition.end,f):f()},a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("alert");e||d.data("alert",e=new c(this)),typeof b=="string"&&e[b].call(d)})},a.fn.alert.Constructor=c,a(function(){a("body").on("click.alert.data-api",b,c.prototype.close)})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){a=="loadingText"?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.parent('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")},a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("button"),f=typeof c=="object"&&c;e||d.data("button",e=new b(this,f)),c=="toggle"?e.toggle():c&&e.setState(c)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=b,a(function(){a("body").on("click.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle")})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.collapse.defaults,c),this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var b,c,d,e;if(this.transitioning)return;b=this.dimension(),c=a.camelCase(["scroll",b].join("-")),d=this.$parent&&this.$parent.find("> .accordion-group > .in");if(d&&d.length){e=d.data("collapse");if(e&&e.transitioning)return;d.collapse("hide"),e||d.data("collapse",null)}this.$element[b](0),this.transition("addClass",a.Event("show"),"shown"),a.support.transition&&this.$element[b](this.$element[0][c])},hide:function(){var b;if(this.transitioning)return;b=this.dimension(),this.reset(this.$element[b]()),this.transition("removeClass",a.Event("hide"),"hidden"),this.$element[b](0)},reset:function(a){var b=this.dimension();return this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element[a!==null?"addClass":"removeClass"]("collapse"),this},transition:function(b,c,d){var e=this,f=function(){c.type=="show"&&e.reset(),e.transitioning=0,e.$element.trigger(d)};this.$element.trigger(c);if(c.isDefaultPrevented())return;this.transitioning=1,this.$element[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("collapse"),f=typeof c=="object"&&c;e||d.data("collapse",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.collapse.defaults={toggle:!0},a.fn.collapse.Constructor=b,a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(b){var c=a(this),d,e=c.attr("data-target")||b.preventDefault()||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(e).data("collapse")?"toggle":c.data();c[a(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),a(e).collapse(f)})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=c,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.prototype={cycle:function(b){return b||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},to:function(b){var c=this.$element.find(".item.active"),d=c.parent().children(),e=d.index(c),f=this;if(b>d.length-1||b<0)return;return this.sliding?this.$element.one("slid",function(){f.to(b)}):e==b?this.pause().cycle():this.slide(b>e?"next":"prev",a(d[b]))},pause:function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle()),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g=b=="next"?"left":"right",h=b=="next"?"first":"last",i=this,j=a.Event("slide",{relatedTarget:e[0]});this.sliding=!0,f&&this.pause(),e=e.length?e:this.$element.find(".item")[h]();if(e.hasClass("active"))return;if(a.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(j);if(j.isDefaultPrevented())return;e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),this.$element.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid")},0)})}else{this.$element.trigger(j);if(j.isDefaultPrevented())return;d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return f&&this.cycle(),this}},a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("carousel"),f=a.extend({},a.fn.carousel.defaults,typeof c=="object"&&c),g=typeof c=="string"?c:f.slide;e||d.data("carousel",e=new b(this,f)),typeof c=="number"?e.to(c):g?e[g]():f.interval&&e.cycle()})},a.fn.carousel.defaults={interval:5e3,pause:"hover"},a.fn.carousel.Constructor=b,a(function(){a("body").on("click.carousel.data-api","[data-slide]",function(b){var c=a(this),d,e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=!e.data("modal")&&a.extend({},e.data(),c.data());e.carousel(f),b.preventDefault()})})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=a(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:b.top+b.height,left:b.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(b){var c;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(c=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,c?this.process(c):this)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){var b=[],c=[],d=[],e;while(e=a.shift())e.toLowerCase().indexOf(this.query.toLowerCase())?~e.indexOf(this.query)?c.push(e):d.push(e):b.push(e);return b.concat(c,d)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(b){var c=this.$menu.find(".active").removeClass("active"),d=c.next();d.length||(d=a(this.$menu.find("li")[0])),d.addClass("active")},prev:function(a){var b=this.$menu.find(".active").removeClass("active"),c=b.prev();c.length||(c=this.$menu.find("li").last()),c.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),(a.browser.webkit||a.browser.msie)&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},move:function(a){if(!this.shown)return;switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()},keydown:function(b){this.suppressKeyPressRepeat=!~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){if(this.suppressKeyPressRepeat)return;this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},blur:function(a){var b=this;setTimeout(function(){b.hide()},150)},click:function(a){a.stopPropagation(),a.preventDefault(),this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")}},a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f=typeof c=="object"&&c;e||d.data("typeahead",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},a.fn.typeahead.Constructor=b,a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);if(c.data("typeahead"))return;b.preventDefault(),c.typeahead(c.data())})})}(window.jQuery)
;define("marker",{}),define("backlog/collections/issues",[],function(){var e={fetch:function(e,t){var n=this;$.ajax({url:"/api/"+e+"/"+t+"/backlog",dataType:"json",success:function(e){n.trigger("ondatareceived",e)}})}};return _.extend(e,Backbone.Events),e}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||undefined),u=[];define("text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),a={version:"0.27.1",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw new Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&i.inlineText&&(u[e]=n),r(n)},load:function(e,t,n,u){var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n,r){if(t in u){var i=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=a.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";a.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},a.write(e,o,n,i)},i)}},a})}(),define("text!backlog/templates/board.html",[],function(){return'<div class="backlog">\n</div>\n'}),define("text!backlog/templates/column.html",[],function(){return'<h3><%= milestone.title %></h3>\n<ul class="sortable"></ul>\n'}),define("text!backlog/templates/card.html",[],function(){return'<a href="#"  title="Close issue" class="close iconic x"><span></span></a>\n<div class="card-header">\n  <div class="title" title="<%= title %>">\n    <%= title %>\n  </div>\n  <a class="number" href="<%= html_url %>" target="_blank" title="View issue on github.com"><small>#</small><%= number %></a>\n</div>\n<% if(assignee) { %>\n <img data-placement="right" rel="twipsy" title="Assigned to <%= assignee.login %>" src="https://secure.gravatar.com/avatar/<%= assignee.gravatar_id %>?s=24" />\n<% } %>\n\n<% if(milestone) { %>\n<div class="milestone">\n   Milestone: <%= milestone.title %>\n</div>\n<% } %>\n<% if (pull_request.html_url) { %><span class="label label-info">Pull request</span> <%}%>\n<div class="card-labels">\n<% _(other_labels).each(function(l) { %>\n<div class="card-label-wrapper"> \n  <div class="card-label -x<%= l.color %> active small"> \n  </div>\n  <div class="card-label -x<%= l.color %> active large"> \n    <span> <%= l.name %> </span>\n  </div>\n</div>\n\n<% }); %>\n\n</div>\n'}),define("common/events/postal",["socket"],function(e){function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}function n(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var r={},i=n();return{correlationId:i,subscribe:function(e,t){postal.channel(e).subscribe(t)},channel:function(e){return postal.channel(e)},publish:function(e,t){postal.channel(e).publish(t)},socket:function(t,n,s){if(!e)return;var o=postal.channel(t);postal.channel(n).subscribe(s);if(r[t])return;r[t]=t,e.on(t,function(e){e.correlationId!==i&&postal.channel(e.event).publish(e.payload)})}}}),define("backlog/models/card",["../../common/events/postal"],function(e){var t=function(e){this.attributes=e.model,this.user=e.user,this.repo=e.repo};return _.extend(t.prototype,{save:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/assignmilestone",{milestone:t.milestone,issue:this.attributes,correlationId:e.correlationId},function(e){})},close:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/close",{index:t.index,issue:this.attributes,correlationId:e.correlationId},function(e){})},assign:function(t){this.attributes.assignee=t,$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/assigncard",{issue:this.attributes,correlationId:e.correlationId,assignee:t.login},function(e){})},reorder:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/reorderissue",{index:t.order,issue:this.attributes,correlationId:e.correlationId},function(e){})}}),t}),define("backlog/views/cardView",["text!../templates/card.html","../models/card","../../common/events/postal"],function(e,t,n){return Backbone.View.extend({initialize:function(e){this.issue=new t({model:e.issue,user:e.user,repo:e.repo}),_.bind(this,"moved",this.moved),_.bind(this,"reorder",this.drop),n.subscribe("Filter.Simple",$.proxy(this.simpleFilter,this)),n.subscribe("Filter.Complex",$.proxy(this.complexFilter,this)),n.socket(e.user+"/"+e.repo,"Closed."+e.issue.number,$.proxy(this.onClosed,this)),n.socket(e.user+"/"+e.repo,"Assigned."+e.issue.number,$.proxy(this.onAssigned,this)),n.socket(e.user+"/"+e.repo,"Updated."+e.issue.number,$.proxy(this.onUpdated,this)),this.filtersHash={simple:{},complex:{}}},events:{moved:"moved","click .close":"closed",drop:"dropped",reorder:"drop","click .number":"onNumber",click:"fullscreen"},tagName:"li",onMoved:function(e){n.publish("Moved.Socket."+e.index,{card:this})},onNumber:function(e){e.stopPropagation()},onUpdated:function(e){this.issue.attributes=_.extend(this.issue.attributes,e.issue),this.render(),this.transition()},onClosed:function(){this.remove(),n.publish("Closed.Issue",{card:this})},fullscreen:function(e){n.publish("Card.Fullscreen",this.issue)},render:function(){$(this.el).html(_.template(e,this.issue.attributes)).droppable({scope:"assignee",hoverClass:"assignee-accept"}).data("issue",this.issue.attributes);if(this.issue.attributes.repo.color){var t=$.Color("#"+this.issue.attributes.repo.color),n="3px solid "+$.Color(t.alpha(.5)).toRgbaString();$(this.el).css({"border-left":n})}return this},moved:function(e,t){this.issue.save({milestone:t.milestone})},dropped:function(e,t){var n=$(t.draggable).data("assignee");this.issue.assign(n),this.onAssigned({assignee:n})},onAssigned:function(e){this.issue.attributes.assignee=e.assignee,this.render()},closed:function(e,t){e.preventDefault(),this.issue.close({index:t}),this.remove(),n.publish("Closed.Issue",{card:this})},transition:function(){var e=[],t=this;setTimeout(function(){for(var n in t.filtersHash.simple)e.push(t.filtersHash.simple[n]);var r=_.filter(e,function(e){return e.state===1}),i=_.filter(e,function(e){return e.state===2});if(_.any(i,function(e){return!e.condition(t.issue.attributes)})){$(t.el).addClass("hide").removeClass("dim active");return}if(_.any(r,function(e){return!e.condition(t.issue.attributes)})){$(t.el).addClass("dim").removeClass("hide active");return}$(t.el).removeClass("dim hide active"),(r.length||i.length)&&$(t.el).addClass("active")},0)},simpleFilter:function(e){var t=this;this.filtersHash.simple[e.id]=e,this.transition()},drop:function(e,t){this.issue.reorder({order:t})}})}),define("backlog/models/milestone",[],function(){var e=function(e){this.attributes=e.model,this.user=e.user,this.repo=e.repo};return _.extend(e.prototype,{save:function(e){if(!e.order||e.order===0)console.error("something wrong happened index should not be 0"),console.log("falling back to original number",this.attributes.number),e.order=this.attributes.number;$.post("/api/"+this.user+"/"+this.repo+"/reordermilestone",{index:e.order,status:e.status,milestone:this.attributes},function(e){})}}),e}),define("backlog/views/columnView",["text!../templates/column.html","./cardView","../../common/events/postal","../models/milestone"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(e){this.column=e.column,this.repo=e.repo,this.user=e.user,this.milestone=new r({model:this.column.milestone,user:e.user,repo:e.repo}),_.bind("reordered",this.reordered)},tagName:"div",className:"column",events:{reorder:"reordered"},reordered:function(e,t){this.milestone.save(t)},onOpened:function(e){var r=new t({issue:e,user:this.user,repo:this.repo});$("ul",this.el).append(r.render().el),n.publish("Opened.Issue",e)},onSocket:function(e){var t=$("li",this.el),n=t.index(e.card.el);if(n!==-1)return;$("ul",this.el).append(e.card.el)},render:function(){var n=$(_.template(e,this.column)),r=this,i=_.map(this.column.issues,function(e){var n=new t({issue:e,user:r.user,repo:r.repo});return n.render().el});return $(this.el).append(n).data("milestone",this.column.milestone).find("ul").append(i),$("ul",this.el).sortable({connectWith:".sortable",placeholder:"ui-sortable-placeholder",receive:$.proxy(this.onReceive,this),remove:$.proxy(this.onRemove,this),over:$.proxy(this.onOver,this),update:$.proxy(this.onStop,this),out:$.proxy(this.onOut,this)}),this},onReceive:function(e,t){$(t.item).trigger("moved",this.column)},onRemove:function(e,t){},onOver:function(e,t){$("ul",this.el).addClass("ui-sortable-hover")},onOut:function(e,t){$("ul",this.el).removeClass("ui-sortable-hover")},onStop:function(e,t){var n=$("li",this.el),r=n.index(t.item);if(r===-1)return;var i=r===0,s=r===n.size()-1,o=$(t.item),u=o.data("issue"),a=n.get(r?r-1:r),f=n.index(a),l=$(a).data("issue"),c=n.get(n.size()-1>r?r+1:r),h=n.index(c),p=$(c).data("issue"),d=u._data.order||u.number,v=l._data.order||l.number,m=p._data.order||p.number;if(i&&s)return;i?(u._data.order=(m||1)/2,o.trigger("reorder",u._data.order).data("issue",u)):s?(u._data.order=v+1,o.trigger("reorder",u._data.order).data("issue",u)):(u._data.order=(m+v||1)/2,o.trigger("reorder",u._data.order).data("issue",u))}});return i}),define("backlog/views/filterView",["../../common/events/postal"],function(e){return jQuery.Color.fn.contrastColor=function(){var e=this._rgba[0],t=this._rgba[1],n=this._rgba[2];return(e*299+t*587+n*144)/1e3>=131.5?"#333":"white"},Backbone.View.extend({tagName:"li",className:"filter",initialize:function(e){this.params=e,this.condition=e.condition,this.name=e.name,this.type=e.type||"Simple",this.state=0,this.states=[0,1,2,0]},events:{click:"clicked",clear:"clearAndPublish","click .iconic":"clearAndPublish"},render:function(){return $(this.el).html("<a href='#'>"+this.name+"<span class='iconic x-alt'></span></a>").addClass("-x"+this.params.color.substring(1)).data("filter",this),this},clicked:function(e){e.preventDefault();switch(this.state=this.states[this.state+1]){case 0:this.clear();break;case 1:this.fade();break;case 2:this.solid()}this.publish()},clear:function(){$(this.el).find("a").removeClass("dim").removeClass("active")},publish:function(){e.publish("Filter."+this.type,{id:this.cid,condition:this.condition,state:this.state})},clearAndPublish:function(e){return e.preventDefault(),this.state=0,this.publish(),this.clear(),!1},fade:function(){$(this.el).find("a").addClass("dim").removeClass("active")},solid:function(){$(this.el).find("a").addClass("active").removeClass("dim")}})}),define("backlog/views/sidebarView",["../../common/events/postal","./filterView"],function(e,t){return Backbone.View.extend({tagName:"ul",className:"filters",initialize:function(e){this.login=e.params.login,this.labels=e.data.other_labels},render:function(){var e=$(this.el),n=this.login,r=(new t({color:"#0069D6",name:"Assigned to me",condition:function(e){return e.assignee&&e.assignee.login===n}})).render(),i=(new t({color:"#0069D6",name:"Assigned to others",condition:function(e){return e.assignee&&e.assignee.login!==n}})).render(),s=(new t({color:"#0069D6",name:"Unassigned issues",condition:function(e){return!e.assignee}})).render(),o=$([r.el,i.el,s.el]);e.append(o),o.click(function(e){e.preventDefault();var t=$(this),n=t.data("filter"),r=_(o).filter(function(e){var t=$(e).data("filter");return n.cid!==t.cid&&t.state!==0});_(r).each(function(e){$(e).trigger("clear")})});var u=_.map(this.labels,function(e){return(new t({color:"#"+e.color,name:e.name,condition:function(t){return _.any(t.labels,function(t){return t.name.toLocaleLowerCase()===e.name.toLocaleLowerCase()})}})).render().el});return e.append("<h5>Labels</h5>"),e.append(u),this}})}),define("backlog/views/headerView",["../../common/events/postal"],function(e){return Backbone.View.extend({el:$(".page-header-wrapper"),events:{"keyup input":"onkeyup"},initialize:function(t){var n=this;this.publish=_.debounce(function(){var t=$(n.el).find("input").val();e.publish("Filter.Simple",{id:"search",condition:function(e){return e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())!==-1},state:2})},300)},onkeyup:function(e){this.publish()}})}),define("text!backlog/templates/assignee.html",[],function(){return'<li class="assignee" data-login="<%= login %>">\n  <img src="https://secure.gravatar.com/avatar/<%= gravatar_id %>?s=24" title="<%=login %>" alt="<%= login %>"/>\n</li>\n'}),define("backlog/views/assigneeView",["text!../templates/assignee.html"],function(e){return Backbone.View.extend({el:$(".page-header-wrapper"),initialize:function(e){var t=this;t.data=e.data,t.render()},render:function(){var t=$(this.el).find("ol"),n=_(this.data.assignees).chain().map(function(t){return $(_.template(e,t)).data("assignee",t)}).value();return t.append(n),t.find("li").draggable({helper:"clone",scope:"assignee",zIndex:100,appendTo:"body"}),this}})}),define("text!backlog/templates/css.html",[],function(){return'<% \n_(["filter","card-label"]).each(function(name){\n  _(other_labels).each(function(l) {\n%>\n  .<%= name %>.-x<%= l.color %>.active, .<%= name %>.-x<%= l.color %>.active:hover  {\n    background-color: #<%= l.color %>;\n    background-color: <%= $.Color("#" + l.color).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  .<%= name %>.-x<%= l.color %> .active, .<%= name %>.-x<%= l.color %> .active:hover  {\n    background-color: #<%= l.color %>;\n    background-color: <%= $.Color("#" + l.color).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n  \n  .<%= name %>.-x<%= l.color %>.dim, .<%= name %>.-x<%= l.color %>.dim:hover  {\n    background-color: <%= $.Color($.Color("#" + l.color).alpha(0.6)).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  .<%= name %>.-x<%= l.color %> .dim ,  .<%= name %>.-x<%= l.color %> .dim:hover {\n    background-color: <%= $.Color($.Color("#" + l.color).alpha(0.6)).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  <%})});%>\n'}),define("backlog/views/cssView",["../collections/issues","text!../templates/css.html"],function(e,t){e.bind("ondatareceived",function(e){var n=_.template(t,e),r=document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),r.appendChild(i)})}),define("backlog/views/board",["../collections/issues","text!../templates/board.html","./columnView","./sidebarView","./headerView","./assigneeView","../../common/events/postal","./cssView"],function(e,t,n,r,i,s,o){var u=function(){var e=_($("ul")).chain().map(function(e){return $(e).height()}).reduce(function(e,t){return t>e?t:e}).value();return e},a=function(e){switch(e){case"open":$("#drawer").find(".toggle-drawer").removeClass("arrow-right").addClass("arrow-left").end().animate({left:"+=270px"},300),$("#content").animate({"margin-left":"+=100px"},300);break;case"close":$("#drawer").animate({left:"-=270px"},300,function(){$(this).find(".toggle-drawer").removeClass("arrow-left").addClass("arrow-right").end()}),$("#content").animate({"margin-left":"-=100px"},300)}};return Backbone.View.extend({el:$("#stage"),events:{"click .toggle-drawer":"toggleDrawer"},initialize:function(t){e.bind("ondatareceived",this.onfetch,this),e.fetch(t.user,t.repo),this.user=t.user,this.repo=t.repo,this.params=t,o.subscribe("Opened.Issue",$.proxy(this.onOpened,this)),o.subscribe("Closed.Issue",$.proxy(this.onClosed,this))},onOpened:function(){this.resizeColumns()},onClosed:function(){this.resizeColumns()},onfetch:function(e){var o=$(_.template(t,e)),u=o.clone(),a=e.unassigned,f=new r({data:e,params:this.params}),l=new i,c=new s({data:e,params:this.params}),h=this;$(u).append((new n({column:a,user:this.user,repo:this.repo})).render().el),_.each(e.milestones,function(e){var t=new n({column:e,user:h.user,repo:h.repo}),r=$(t.render().el).css({width:"260px"});$(o).append(r)}),$("#stage").append(o),$(o).sortable({axis:"x",handle:"h3",cursor:"move",stop:$.proxy(this.fullStop,this),start:$.proxy(this.onStart,this),remove:$.proxy(this.onRemove,this),over:$.proxy(this.onOver,this),update:$.proxy(this.onStop,this)}),$("#drawer","#main-stage").append(f.render().el).find(".toggle-drawer").show(),$(".sidebar-wrapper").append(u).show(),$('[rel~="twipsy"]').tooltip({live:!0}),this.resizeColumns()},resizeColumns:function(){var e=u();$("ul","#main-stage").css("min-height",e)},toggleDrawer:function(e){e.preventDefault();var t=$(".toggle-drawer").hasClass("arrow-left");t?a("close"):a("open")},onReceive:function(e,t){},onRemove:function(e,t){},onOver:function(e,t){},onOut:function(e,t){},fullStop:function(e,t){$(t.item).removeClass("ui-state-dragging")},onStart:function(e,t){$(t.item).addClass("ui-state-dragging")},onStop:function(e,t){var n=$(".backlog > div",this.el),r=n.index(t.item);if(r===-1)return;var i=r===0,s=r===n.size()-1,o=$(t.item),u=o.data("milestone"),a=n.get(r?r-1:r),f=n.index(a),l=$(a).data("milestone"),c=n.get(n.size()-1>r?r+1:r),h=n.index(c),p=$(c).data("milestone"),d=u._data.order||u.number,v=l._data.order||l.number,m=p._data.order||p.number;if(i&&s)u._data.order=d;else if(i){var g=m||1;u._data.order=g-1>0?g-1:g/2}else s?u._data.order=v+1:u._data.order=(m+v||1)/2;o.trigger("reorder",{order:u._data.order}).data("milestone",u)}})}),define("backlog/main",["./views/board"],function(e){var t={};return{init:function(n){t.board=new e(n)}}}),define("board/collections/issues",[],function(){var e={fetch:function(e,t){var n=this,r=$.ajax({url:"/api/"+e+"/"+t+"/board",dataType:"json",success:function(e){}}),i=$.ajax({url:"/api/"+e+"/"+t+"/column",dataType:"json"});$.when(r).then(function(e){n.trigger("ondatareceived",e),_.each(e.labels,function(e){n.trigger("onissuesreceived."+e.index,e.issues)}),n.trigger("afterreceived"),$.when(i).then(function(e){n.trigger("onissuesreceived.0",e.issues),n.trigger("afterreceived")})})}};return _.extend(e,Backbone.Events),e}),define("text!board/templates/board.html",[],function(){return'<div class="board">\n</div>\n'}),define("text!board/templates/column.html",[],function(){return'<div class="column">\n<h3><%= text %></h3>\n<ul class="sortable"></ul>\n</div>\n'}),define("text!board/templates/card.html",[],function(){return'<a href="#"  title="Close issue" class="close iconic x"><span></span></a>\n<div class="card-header">\n  <div class="title" title="<%= title %>">\n    <%= title %>\n  </div>\n  <a class="number" href="<%= html_url %>" target="_blank" title="View issue on github.com"><small>#</small><%= number %></a>\n</div>\n<% if(assignee) { %>\n <img data-placement="right" rel="twipsy" title="Assigned to <%= assignee.login %>" src="https://secure.gravatar.com/avatar/<%= assignee.gravatar_id %>?s=24" />\n<% } %>\n\n<% if(milestone) { %>\n<div class="milestone">\n   Milestone: <%= milestone.title %>\n</div>\n<% } %>\n<% if(pull_request.html_url) { %>\n  <span class="label label-info">Pull request</span>\n<% } %>\n<div class="card-labels">\n<% _(other_labels).each(function(l) { %>\n<div class="card-label-wrapper"> \n  <div class="card-label -x<%= l.color %> active small"> \n  </div>\n  <div class="card-label -x<%= l.color %> active large"> \n    <span> <%= l.name %> </span>\n  </div>\n</div>\n\n<% }); %>\n\n</div>\n'}),define("board/models/card",["../../common/events/postal"],function(e){var t=function(e){this.attributes=e.model,this.user=e.user,this.repo=e.repo};return _.extend(t.prototype,{save:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/movecard",{index:t.index,issue:this.attributes,correlationId:e.correlationId},function(e){})},close:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/close",{index:t.index,issue:this.attributes,correlationId:e.correlationId},function(e){})},assign:function(t){this.attributes.assignee=t,$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/assigncard",{issue:this.attributes,correlationId:e.correlationId,assignee:t.login},function(e){})},reorder:function(t){$.post("/api/"+this.attributes.repo.owner.login+"/"+this.attributes.repo.name+"/reorderissue",{index:t.order,issue:this.attributes,correlationId:e.correlationId},function(e){})}}),t}),define("board/views/cardView",["text!../templates/card.html","../models/card","../../common/events/postal"],function(e,t,n){return Backbone.View.extend({initialize:function(e){this.issue=new t({model:e.issue,user:e.user,repo:e.repo}),_.bind(this,"moved",this.moved),_.bind(this,"reorder",this.drop),n.subscribe("Filter.Simple",$.proxy(this.simpleFilter,this)),n.subscribe("Filter.Complex",$.proxy(this.complexFilter,this)),n.socket(e.user+"/"+e.repo,"Moved."+e.issue.number,$.proxy(this.onMoved,this)),n.socket(e.user+"/"+e.repo,"Closed."+e.issue.number,$.proxy(this.onClosed,this)),n.socket(e.user+"/"+e.repo,"Assigned."+e.issue.number,$.proxy(this.onAssigned,this)),n.socket(e.user+"/"+e.repo,"Updated."+e.issue.number,$.proxy(this.onUpdated,this)),this.filtersHash={simple:{},complex:{}}},events:{moved:"moved","click .close":"closed",drop:"dropped",reorder:"drop","click .number":"onNumber",click:"fullscreen"},tagName:"li",onNumber:function(e){e.stopPropagation()},onMoved:function(e){n.publish("Moved.Socket."+e.index,{card:this})},onUpdated:function(e){this.issue.attributes=_.extend(this.issue.attributes,e.issue),this.render(),this.transition()},onClosed:function(){this.remove(),n.publish("Closed.Issue",{card:this})},fullscreen:function(e){n.publish("Card.Fullscreen",this.issue)},render:function(){$(this.el).html(_.template(e,this.issue.attributes)).droppable({scope:"assignee",hoverClass:"assignee-accept"}).data("issue",this.issue.attributes);if(this.issue.attributes.repo.color){var t=$.Color("#"+this.issue.attributes.repo.color),n="3px solid "+$.Color(t.alpha(.5)).toRgbaString();$(this.el).css({"border-left":n})}return this},moved:function(e,t){this.issue.save({index:t})},dropped:function(e,t){var n=$(t.draggable).data("assignee");this.issue.assign(n),this.onAssigned({assignee:n})},onAssigned:function(e){this.issue.attributes.assignee=e.assignee,this.render()},closed:function(e,t){e.preventDefault(),e.stopPropagation(),this.issue.close({index:t}),this.remove(),n.publish("Closed.Issue",{card:this})},transition:function(){var e=[],t=this;setTimeout(function(){for(var n in t.filtersHash.simple)e.push(t.filtersHash.simple[n]);var r=_.filter(e,function(e){return e.state===1}),i=_.filter(e,function(e){return e.state===2});if(_.any(i,function(e){return!e.condition(t.issue.attributes)})){$(t.el).addClass("hide").removeClass("dim active");return}if(_.any(r,function(e){return!e.condition(t.issue.attributes)})){$(t.el).addClass("dim").removeClass("hide active");return}$(t.el).removeClass("dim hide active"),(r.length||i.length)&&$(t.el).addClass("active")},0)},simpleFilter:function(e){var t=this;this.filtersHash.simple[e.id]=e,this.transition()},drop:function(e,t){this.issue.reorder({order:t})}})}),define("board/views/columnView",["../collections/issues","text!../templates/column.html","./cardView","../../common/events/postal"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(t){this.column=t.column,this.repo=t.repo,this.user=t.user,this.latched=!1,r.subscribe("Moved.Socket."+t.column.index,$.proxy(this.onSocket,this)),r.socket(t.user+"/"+t.repo,"Opened."+t.column.index,$.proxy(this.onOpened,this)),e.bind("onissuesreceived."+t.column.index,this.onfetch,this)},onfetch:function(e){var t=_.map(e,function(e){var t=new n({issue:e,user:self.user,repo:self.repo});return t.render().el});$("ul",this.el).append(t)},onOpened:function(e){var t=new n({issue:e,user:this.user,repo:this.repo});$("ul",this.el).append(t.render().el),r.publish("Opened.Issue",e)},onSocket:function(e){var t=$("li",this.el),n=t.index(e.card.el);if(n!==-1)return;$("ul",this.el).append(e.card.el)},render:function(){var e=$(_.template(t,this.column)),n=this;return this.el=e,$("ul",this.el).sortable({connectWith:".sortable",placeholder:"ui-sortable-placeholder",receive:$.proxy(this.onReceive,this),remove:$.proxy(this.onRemove,this),over:$.proxy(this.onOver,this),update:$.proxy(this.onStop,this),out:$.proxy(this.onOut,this)}),this},onReceive:function(e,t){$(t.item).trigger("moved",this.column.index)},onRemove:function(e,t){},onOver:function(e,t){$("ul",this.el).addClass("ui-sortable-hover")},onOut:function(e,t){$("ul",this.el).removeClass("ui-sortable-hover")},onStop:function(e,t){var n=$("li",this.el),r=n.index(t.item);if(r===-1)return;var i=r===0,s=r===n.size()-1,o=$(t.item),u=o.data("issue"),a=n.get(r?r-1:r),f=n.index(a),l=$(a).data("issue"),c=n.get(n.size()-1>r?r+1:r),h=n.index(c),p=$(c).data("issue"),d=u._data.order||u.number,v=l._data.order||l.number,m=p._data.order||p.number;if(i&&s)return;i?(u._data.order=(m||1)/2,o.trigger("reorder",u._data.order).data("issue",u)):s?(u._data.order=v+1,o.trigger("reorder",u._data.order).data("issue",u)):(u._data.order=(m+v||1)/2,o.trigger("reorder",u._data.order).data("issue",u))}});return i}),define("board/views/filterView",["../../common/events/postal"],function(e){return jQuery.Color.fn.contrastColor=function(){var e=this._rgba[0],t=this._rgba[1],n=this._rgba[2];return(e*299+t*587+n*144)/1e3>=131.5?"#333":"white"},Backbone.View.extend({tagName:"li",className:"filter",initialize:function(e){this.params=e,this.condition=e.condition,this.name=e.name,this.type=e.type||"Simple",this.state=0,this.states=[0,1,2,0]},events:{click:"clicked",clear:"clearAndPublish","click .iconic":"clearAndPublish"},render:function(){return $(this.el).html("<a href='#'>"+this.name+"<span class='iconic x-alt'></span></a>").addClass("-x"+this.params.color.substring(1)).data("filter",this),this},clicked:function(e){e.preventDefault();switch(this.state=this.states[this.state+1]){case 0:this.clear();break;case 1:this.fade();break;case 2:this.solid()}this.publish()},clear:function(){$(this.el).find("a").removeClass("dim").removeClass("active")},publish:function(){e.publish("Filter."+this.type,{id:this.cid,condition:this.condition,state:this.state})},clearAndPublish:function(e){return e.preventDefault(),this.state=0,this.publish(),this.clear(),!1},fade:function(){$(this.el).find("a").addClass("dim").removeClass("active")},solid:function(){$(this.el).find("a").addClass("active").removeClass("dim")}})}),define("board/views/sidebarView",["../../common/events/postal","./filterView"],function(e,t){return Backbone.View.extend({tagName:"ul",className:"filters",initialize:function(e){this.milestones=e.data.milestones,this.login=e.params.login,this.labels=e.data.other_labels},render:function(){var e=$(this.el),n=this.login,r=(new t({color:"#0069D6",name:"Assigned to me",condition:function(e){return e.assignee&&e.assignee.login===n}})).render(),i=(new t({color:"#0069D6",name:"Assigned to others",condition:function(e){return e.assignee&&e.assignee.login!==n}})).render(),s=(new t({color:"#0069D6",name:"Unassigned issues",condition:function(e){return!e.assignee}})).render(),o=$([r.el,i.el,s.el]);e.append(o),o.click(function(e){e.preventDefault();var t=$(this),n=t.data("filter"),r=_(o).filter(function(e){var t=$(e).data("filter");return n.cid!==t.cid&&t.state!==0});_(r).each(function(e){$(e).trigger("clear")})});var u=_.groupBy(this.milestones,function(e){return e._data.status||"backlog"}),a=(u.wip||[]).concat(u.backlog||[]),f=_.map(a,function(e){return(new t({color:"#0069D6",name:e.title,count:e.open_issues,condition:function(t){return t.milestone&&t.milestone.title.toLocaleLowerCase()===e.title.toLocaleLowerCase()}})).render().el}),l=(new t({color:"#0069D6",name:"No milestone assigned",condition:function(e){return!e.milestone}})).render().el;e.append("<h5>Milestones</h5>"),e.append(l),e.append(f),$(f.concat(l)).click(function(e){e.preventDefault();var t=$(this),n=t.data("filter"),r=_(f.concat(l)).filter(function(e){var t=$(e).data("filter");return n.cid!==t.cid&&t.state!==0});_(r).each(function(e){$(e).trigger("clear")})});var c=_.map(this.labels,function(e){return(new t({color:"#"+e.color,name:e.name,condition:function(t){return _.any(t.labels,function(t){return t.name.toLocaleLowerCase()===e.name.toLocaleLowerCase()})}})).render().el});return e.append("<h5>Labels</h5>"),e.append(c),this}})}),define("board/views/headerView",["../../common/events/postal"],function(e){return Backbone.View.extend({el:$(".page-header-wrapper"),events:{"keyup input":"onkeyup"},initialize:function(t){var n=this;this.publish=_.debounce(function(){var t=$(n.el).find("input").val();e.publish("Filter.Simple",{id:"search",condition:function(e){return e.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())!==-1},state:2})},300)},onkeyup:function(e){this.publish()}})}),define("text!board/templates/assignee.html",[],function(){return'<li class="assignee" data-login="<%= login %>">\n  <img src="https://secure.gravatar.com/avatar/<%= gravatar_id %>?s=24" title="<%=login %>" alt="<%= login %>"/>\n</li>\n'}),define("board/views/assigneeView",["text!../templates/assignee.html"],function(e){return Backbone.View.extend({el:$(".page-header-wrapper"),initialize:function(e){var t=this;t.data=e.data,t.render()},render:function(){var t=$(this.el).find("ol"),n=_(this.data.assignees).chain().map(function(t){return $(_.template(e,t)).data("assignee",t)}).value();return t.append(n),t.find("li").draggable({helper:"clone",scope:"assignee",zIndex:100,appendTo:"body"}),this}})}),define("text!board/templates/css.html",[],function(){return'<% \n_(["filter","card-label"]).each(function(name){\n  _(other_labels).each(function(l) {\n%>\n  .<%= name %>.-x<%= l.color %>.active, .<%= name %>.-x<%= l.color %>.active:hover  {\n    background-color: #<%= l.color %>;\n    background-color: <%= $.Color("#" + l.color).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  .<%= name %>.-x<%= l.color %> .active, .<%= name %>.-x<%= l.color %> .active:hover  {\n    background-color: #<%= l.color %>;\n    background-color: <%= $.Color("#" + l.color).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n  \n  .<%= name %>.-x<%= l.color %>.dim, .<%= name %>.-x<%= l.color %>.dim:hover  {\n    background-color: <%= $.Color($.Color("#" + l.color).alpha(0.6)).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  .<%= name %>.-x<%= l.color %> .dim ,  .<%= name %>.-x<%= l.color %> .dim:hover {\n    background-color: <%= $.Color($.Color("#" + l.color).alpha(0.6)).toString() %>;\n    color: <%= $.Color("#" + l.color).contrastColor() %>;\n  }\n\n  <%})});%>\n'}),define("board/views/cssView",["../collections/issues","text!../templates/css.html"],function(e,t){e.bind("ondatareceived",function(e){var n=_.template(t,e),r=document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),r.appendChild(i)})}),define("board/views/board",["../collections/issues","text!../templates/board.html","./columnView","./sidebarView","./headerView","./assigneeView","../../common/events/postal","./cssView"],function(e,t,n,r,i,s,o){var u=function(){var e=_($("ul")).chain().map(function(e){return $(e).height()}).reduce(function(e,t){return t>e?t:e}).value();return e},a=function(e){switch(e){case"open":$("#drawer").find(".toggle-drawer").removeClass("arrow-right").addClass("arrow-left").end().animate({left:"+=270px"},300),$("#content").animate({"margin-left":"+=100px"},300);break;case"close":$("#drawer").animate({left:"-=270px"},300,function(){$(this).find(".toggle-drawer").removeClass("arrow-left").addClass("arrow-right").end()}),$("#content").animate({"margin-left":"-=100px"},300)}};return Backbone.View.extend({el:$("#stage"),events:{"click .toggle-drawer":"toggleDrawer"},initialize:function(t){e.bind("ondatareceived",this.onfetch,this),e.bind("afterreceived",this.resizeColumns,this),e.fetch(t.user,t.repo),this.user=t.user,this.repo=t.repo,this.params=t,o.subscribe("Opened.Issue",$.proxy(this.onOpened,this)),o.subscribe("Closed.Issue",$.proxy(this.onClosed,this))},onOpened:function(){this.resizeColumns()},onClosed:function(){this.resizeColumns()},onfetch:function(e){if(!e.labels.length){window.location.href="/"+this.user+"/"+this.repo+"/board/create";return}var o=$(_.template(t,e)),u=o.clone(),a=_.first(e.labels),f=_.rest(e.labels),l=new r({data:e,params:this.params}),c=new i,h=new s({data:e,params:this.params}),p=this;$(u).append((new n({column:a,user:this.user,repo:this.repo})).render().el);var d=100/f.length;_.each(f,function(e){var t=new n({column:e,user:p.user,repo:p.repo}),r=$(t.render().el).css({width:d+"%"});$(o).append(r)}),$("#stage").append(o),$("#drawer","#main-stage").append(u).find(".toggle-drawer").show(),$(".sidebar-wrapper").append(l.render().el).show(),$('[rel~="twipsy"]').tooltip({live:!0}),this.resizeColumns()},resizeColumns:function(){var e=u();$("ul","#main-stage").css("min-height",e)},toggleDrawer:function(e){e.preventDefault();var t=$(".toggle-drawer").hasClass("arrow-left");t?a("close"):a("open")}})}),define("board/main",["./views/board"],function(e){var t={};return{init:function(n){t.board=new e(n)}}}),define("text!card/templates/card.html",[],function(){return'<div class="fullscreen-card-right">\n\n</div>\n<div class="fullscreen-card-left">\n  <div class=\'fullscreen-card-preamble\'>\n    <div class="fullscreen-header">\n      <h2> <%= title %> </h2>\n    </div>\n  </div>\n\n  <div class="fullscreen-card-description">\n    <%= body_html %>\n  </div>\n</div>\n'}),define("text!card/templates/feed.html",[],function(){return'\n  <div class="fullscreen-card-activity">\n    <div class="fullscreen-header">\n      <h3> Activity </h3>\n    </div>\n    <% _(issue.comments).each(function(c) { %>\n    <div class="card-comment">\n      <img  src="https://secure.gravatar.com/avatar/<%= c.user.gravatar_id%>?s=30" />\n      <div class="comment-body">\n        <%= c.body_html %>\n      </div>\n    </div>\n    <% }); %>\n  </div>\n'}),define("text!card/templates/actions/labels.html",[],function(){return'\n\n  <ul class="labels"> \n    <h5> Labels </h5>\n  <% _(available_labels).each(function(l) { %>\n    <li class="card-label -x<%= l.color %>"> \n    <% if(_.find(current_labels, function(x){ return x.name === l.name})) { %>\n      <span class="active"> <%= l.name %> </span>\n      <input type="checkbox" style="display:none" name="labels[name][]" value=\'<%= l.name %>\' checked=\'checked\' />\n      <% } else {  %>\n        <span > <%= l.name %> </span>\n        <input type=\'checkbox\' style="display:none" name="labels[name][]" value=\'<%= l.name %>\' />\n      <% } %>\n    </li>\n  <% }); %>\n  </ul>\n'}),define("card/views/actions/labels",["text!../../templates/actions/labels.html"],function(e){var t=Backbone.View.extend({initialize:function(e,t){this.data=e,this.issue=t},events:{"click li":"update"},render:function(){var t=this.issue,n="/api/"+t.attributes.repo.owner.login+"/"+t.attributes.repo.name+"/issues/"+t.attributes.number+"/update_labels";return $(this.el).append("<form action='"+n+"'>").find("form").html(_.template(e,this.data)),this},update:function(e,t){var n=$(e.currentTarget),r=n.find("span").toggleClass("active"),i=n.find("input");i.prop("checked",!i.prop("checked"));var s=$(this.el).find("form"),o=s.serialize();$.ajax({url:s.attr("action"),data:o,dataType:"json",type:"POST"}).done(function(e){console.log(e)})}});return{create:function(e,n){return new t(e,n)}}}),define("card/views/card",["../../common/events/postal","text!../templates/card.html","text!../templates/feed.html","./actions/labels"],function(e,t,n,r){return Backbone.View.extend({tagName:"div",className:"fullscreen-card",initialize:function(t){e.subscribe("Card.Fullscreen",$.proxy(this.open,this))},render:function(e){return $(this.el).html(_.template(t,e)),this},open:function(e){var t=this;this.issue=e,this.render(e.attributes),$.getJSON("/api/"+e.attributes.repo.owner.login+"/"+e.attributes.repo.name+"/issues/"+e.attributes.number+"/feed").done(function(e){$(t.el).find(".fullscreen-card-left").append(_.template(n,e)),$(t.el).find(".fullscreen-card-right").append(r.create(e.actions.labels,t.issue).render().el)})}})}),define("card/main",["../common/events/postal","./views/card"],function(e,t){var n={open:function(){$("body").addClass("fullscreen-open")},close:function(){$("body").removeClass("fullscreen-open")},init:function(){$(".fullscreen-card").click(function(e){e.stopPropagation()}),$(".fullscreen-overlay").click(n.close),e.subscribe("Card.Fullscreen",$.proxy(this.open,this))}};return{init:function(e){n.card=new t(e),$(this).append(n.card.el),n.init()}}})
